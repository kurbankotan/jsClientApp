<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <button onclick="getProducts()">Get Products</button>
    <button onclick="getProductById()">Get Product</button>
    <button onclick="login()">Login</button>

    <div id="divProducts">
                                            
    </div>



    <script>

        const login = async () => {
            const response = await fetch("https://localhost:7201/api/users/login", {
                        headers:{
                            "Accept": "application/json",
                            "Content-Type": "application/json"
                        },
                        method: "POST",
                        body: JSON.stringify({email: 'kurban@kotan.com', password: '123456'}) //Bunlar için arayüz yap ve dışardan giriş yapılsın
            });

            const result = await response.json();
            //console.log(result);
            localStorage.setItem("token", JSON.stringify(result.token));
        }

        const getProducts = async () => {

          const response = await fetch("https://localhost:7201/api/products") //API'nin yayınlandığı adres olmalı. Değiştir
          const products = await response.json();
          console.log(products);                                               //Console'da gelen products bilgilerini görelim
            displayProducts(products);                                        //Bilgileri sayfa üzerinde göster

        }


        const getProductById = async () =>{
            const token = JSON.parse(localStorage.getItem("token"));
            const response = await fetch("https://localhost:7201/api/products/2", {
                headers:{Authorization: `Bearer ${token}`}
            }); //API'nin yayınlandığı adres olmalı. Değiştir.
            
            const product = await response.json()                                  // Ve burası için ürün ID'nin giriş yapılabileceği bir arayüz yap
            //console.log(product); 
            displayProduct(product);  
        }





        const displayProducts = (products) =>{                                //function displayProducts(products){ } ile aynı
            
            const parent = document.getElementById("divProducts");
            products.forEach(prd => {
                                                            // Dikkat aşağıdaki 2 tane back tick işareti arasına yazılacak
                    parent.innerHTML += `                         
                                            <div>
                                                <h5>${prd.productName}</h5>
                                                <h5>${prd.price}</h5>
                                            </div>
                                        `;                                 
            });
        }



        const displayProduct = (product) =>{                                //function displayProducts(products){ } ile aynı
            
            const parent = document.getElementById("divProducts");

                    parent.innerHTML = `                         
                                            <div>
                                                <h5>${product.productName}</h5>
                                                <h5>${product.price}</h5>
                                            </div>
                                        `;                                 
        }



    </script>
</body>
</html>